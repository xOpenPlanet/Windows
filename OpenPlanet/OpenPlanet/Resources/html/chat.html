<html>
<head>
    <title></title>
    <style>
    	* {font-family:"microsoft yahei";}
        img {
            max-width: 100px;
            max-height: 100px;
            margin: 0 0;
        }
        ul {
        	margin-bottom: 1px;
        }
        /*定义显示的格式*/
        p {
            color: black;
            font-family: "microsoft yahei";
            font-size: 14px;
            display: inline;
        }
        /*自己的消息*/
        .myMsg {
            max-height: 300px;
            max-width: 300px;
            position: relative;
            float: right;
        }
        /*显示自己的头像*/
        .divMyHead {
            position: relative;
            float: right;
            margin: 5px 0px 5px 0px;
            right: 1px;
            border-radius: 5px;
        }
        /*对方的消息*/
        .otherMsg {
            max-height: 300px;
            max-width: 300px;
            position: relative;
            float: right;
        }
        /*显示对方的头像*/
        .divotherHead {
            position: relative;
            float: left;
            margin: 5px 0px 0px 0px;
            left: 1px;
            border-radius: 5px;
            width: 40px;
        }
        .divMyHead>img, .divotherHead>img {
        	border-radius: 15px;
        }
        /*实现对方发送来的消息的方框*/
        .triangle-left {
            float: left;
            max-width: 350px;
            border: 1px solid #ffffff;
            border-radius: 5px;
            padding: 4px;
            background: #bbcbd3;
            position: relative;
            display: inline-block;
            margin: 5px 0px 5px 0px;
            word-wrap: break-word;
            line-height: 20px;
            padding: 5px;
        }

            .triangle-left:before {
                position: absolute;
                content: "";
                display: block;
            }
            /*实现对方消息的那个小三角，小三角的实现其实是将一个正方形对角线划分为四个小三角，其余的三个设置颜色不可见，只将对自己有用的那一个留下来*/
            .triangle-left.left:before {
                border-color: rgba(0, 0, 0, 0) #bbcbd3 rgba(0, 0, 0, 0) rgba(0, 0, 0, 0);
                border-width: 5px 5px 5px 0;
                border-style: solid;
                bottom: auto;
                left: -5px;
                top: 3px;
            }

            .triangle-left.left:after {
                border-color: rgba(0, 0, 0, 0) #ffffff rgba(0, 0, 0, 0) rgba(0, 0, 0, 0);
                border-width: 5px 5px 5px 0;
                border-style: solid;
                bottom: auto;
                left: -5px;
                top: 8px;
            }
        /*实现右边的气泡*/
        .triangle-right {
            float: right;
            max-width: 350px;
            border: 1px solid #bedfff;
            border-radius: 5px;
            padding: 5px;
            background: #bedfff;
            position: relative;
            display: inline-block;
            margin: 5px 1px 5px 0;
            word-wrap: break-word;
        }

            .triangle-right:before {
                position: absolute;
                content: "";
                display: block;
            }

            .triangle-right.right:before {
                border-color: rgba(0, 0, 0, 0) rgba(0, 0, 0, 0) rgba(0, 0, 0, 0) #bedfff;
                border-width: 5px 0px 5px 5px;
                border-style: solid;
                bottom: auto;
                right: -6px;
                top: 8px;
            }

            .triangle-right:after {
                position: absolute;
                content: "";
                display: block;
            }

            .triangle-right.right:after {
                border-color: rgba(0, 0, 0, 0) rgba(0, 0, 0, 0) rgba(0, 0, 0, 0) #bedfff;
                border-width: 5px 0px 5px 5px;
                border-style: solid;
                bottom: auto;
                right: -6px;
                top: 8px;
            }

        ul {
            height: auto;
            float: right;
        }

        li {
            list-style: none;
            margin-top: -15px;
            line-height: 20px;
            float: right; /*wxd add  使发送状态在消息右边*/
        }

        .MessageState {
            font-size: 10px;
            color: #0A0A0A;
            float: right;
            margin: 0 auto;
            margin-right: 3px;
            margin-top: 20px;
            padding: 2px 4px;
            background-color: #FFFFFF;
        }

        .btn ul li {
            overflow: hidden;
            float: right;
        }

        .lb div {
            float: left;
        }

        .namesta ul li {
            overflow: hidden;
            float: none;
        }
    </style>
    <script language="JavaScript">
        function GetMsgState(msgState) {
            switch (msgState) {
                case 0:                         //待发送
                    //return "待发送";
                    return "qrc:/MessageRemined/Resources/MessageReminder/wait_for_send.png";
                    break;
                case 1:
                    //return "预发送";
                    return "qrc:/MessageRemined/Resources/MessageReminder/wait_for_send.png";
                    break;
                case 2:
                    //return "发送中";
                    return "qrc:/MessageRemined/Resources/MessageReminder/send_ing.png";
                    break;
                case 3:
                    //return "已投递";
                    return "qrc:/MessageRemined/Resources/MessageReminder/delivered.png";
                    break;
                case 4:
                    //return "已发送";
                    return "qrc:/MessageRemined/Resources/MessageReminder/send_ed.png";
                    break;
                case 5:
                    //return "已送达";
                    return "qrc:/MessageRemined/Resources/MessageReminder/sent.png";
                    break;
                case 6:
                    //return "已查看";
                    return "qrc:/MessageRemined/Resources/MessageReminder/viewed.png";
                    break;
                case 7:
                    return "qrc:/MessageRemined/Resources/MessageReminder/unviewed.png";
                    break;
                case 8:
                    //return "发送失败";
                    return "qrc:/MessageRemined/Resources/MessageReminder/send_failed.png";
                    break;
                default:
                    // return "erro";
                    return "qrc:/MessageRemined/Resources/MessageReminder/delete.png";
                    break;
            }
        }
        function SetMsgState(msgID, msgState) {
            var strMsgState = GetMsgState(msgState);
            var objState = document.getElementById(msgID);
            if (objState != null) {
                //objState.innerText = strMsgState;
                objState.src = strMsgState;
            }
        }
        function ReplaceImage(msgID, filePath) {
            var div = document.getElementById(msgID);
            if (obj != null) {
                //objState.innerText = strMsgState;
                obj.innerHTML = filePath;
            }
        }
        function img() {

        }
        function addFile() {
            var str = '<INPUT type="file" size="20" NAME="File">'
            //document.getElementById("MyFile").insertAdjacentHTML("beforeEnd", str)
            document.getElementById("content").insertAdjacentHTML("beforeEnd", str)
            // alert("hello word!")
        }
        function getAll() {
            content = document.body.innerHTML
        }
        function SendAppend(strImgPath, strMsg, strMsgID, MsgState) {
            var obj = document.getElementById("content");
            var strMsgState = GetMsgState(MsgState);

            obj.insertAdjacentHTML("beforeEnd",
                "<div style='overflow:hidden;'>\
                    <p class='divMyHead'>\
                        <img width=30px height=30px src =" + strImgPath + " \>\
                    </p>\
                    <div style='float:right;'>\
                        <ul class=''>\
                            <li>\
                                <img id=" + strMsgID + " class='MessageState' style='border-radius:50%;' width=12px height=12px src=\"" + strMsgState + "\"\>\
                            </li>\
                            <li>\
                                <p class='triangle-right right' ondblclick=\"ChangeSize(this)\">" + strMsg + "</p>\
                            </li>\
                        </ul>\
                    </div>\
                 </div>");
                 
            window.setTimeout("window.scrollTo(0, document.body.scrollHeight);", 0);
        }

        function SendGroupAppend(strImgPath, strMsg, strMsgID, MsgState) {
            var obj = document.getElementById("content");
            var strMsgState = GetMsgState(MsgState);

            obj.insertAdjacentHTML("beforeEnd",
                "<div style='overflow:hidden;'>\
                    <p class='divMyHead'>\
                        <img width=30px height=30px src =" + strImgPath + " \>\
                    </p>\
                    <div style='float:right;'>\
                        <ul class=''>\
                            <li>\
                                <img id=" + strMsgID + " class='MessageState' style='border-radius:50%;' width=12px height=12px src=\"" + strMsgState + "\"\>\
                            </li>\
                            <li>\
                                <p class='triangle-right right' ondblclick=\"ChangeGroupSize(this)\">" + strMsg + "</p>\
                            </li>\
                        </ul>\
                    </div>\
                 </div>");
            window.setTimeout("window.scrollTo(0, document.body.scrollHeight);", 0);
        }

        function ChangeID(oldID, newID) {
            document.getElementById(oldID).setAttribute("id", newID);//改ID
        }
        //added by wangqingjie

        //js截取字符串，中英文都能用
        //如果给定的字符串大于指定长度，截取指定长度返回，否者返回源字符串。
        //字符串，长度

        /**
         * js截取字符串，中英文都能用
         * @param str：需要截取的字符串
         * @param len: 需要截取的长度
         */
        function cutstr(str, len) {
            var str_length = 0;
            var str_len = 0;
            str_cut = new String();
            str_len = str.length;
            for (var i = 0; i < str_len; i++) {
                a = str.charAt(i);
                str_length++;
                if (escape(a).length > 4) {
                    //中文字符的长度经编码之后大于4
                    str_length++;
                }
                str_cut = str_cut.concat(a);
                if (str_length >= len) {
                    str_cut = str_cut.concat("...");
                    return str_cut;
                }
            }
            //如果给定字符串小于指定长度，则返回源字符串；
            if (str_length < len) {
                return str;
            }
        }

        //added by wangqingjie
        function ProgressBar(ID, num) {
            var obj = document.getElementById(ID);
            obj.style.width = num + "px";
            obj.style.backgroundColor = "#90EE90";
        }

        function SendFile(strImgPath, strFileName, strMsgID, MsgState, strPicPath, strLiID, size) {
            var obj = document.getElementById("content");
            var strMsgState = GetMsgState(MsgState);

            var strMsg = cutstr(strFileName, 15);
            var progressID = strMsgID.concat("bar");
            var CancleID = strMsgID.concat("can");
            obj.insertAdjacentHTML("beforeEnd",
                "<div style='overflow:hidden;'>\
                    <p class='divMyHead'>\
                        <img width=30px height=30px src =" + strImgPath + " />\
                    </p>\
                    <div style='float:right;'>\
                         <ul class=''>\
                            <li>\
                                <img id=" + strMsgID + " class='MessageState' style='border-radius:50%;' width=12px height=12px src=" + strMsgState + "\>\
                            </li>\
                            <li>\
                                <div class='triangle-right right' style=\"width:250px;height:90\">\
                                <div style='width: 100%;height: 100%;background-color: white;'>\
                                    <div class='lb'style=\"height:60px;\">\
                                        <div><img  style='margin: 5px;' width=54x height=54px src="+ strPicPath + " /></div>\
                                        <div class='namesta' style=\"margin:0 auto;\">\
                                            <ul id=" + strLiID + " style=\"margin:0 auto;padding-left:15px \">\
                                                <li style='font-size:12px;height:25px;margin-top:10px;color:black'>" + strMsg + "  " + size + " </li>\
                                                <li  style='font-size:12px;margin-top:5px;'>正在发送文件...</li>\
                                            </ul>\
                                       </div>\
                                    </div>\
                                    <div style=\"margin-top:3px;padding-top:6px;width: 250px; height: 0px; border: solid 0px #ccc; position:relative\">\
                                        <div style=\"background-color: #E0EEE0; width: 250px; height: 1px;position:absolute;left:0;top:0\"></div>\
                                        <div id=" + progressID + " style=\"background-color: #E0EEE0; width: 250px; height: 1px;position:absolute;left:0;top:0\"></div>\
                                    </div>\
                                    <div class='btn'style=\"margin:0 auto;\">\
                                        <ul id="+ CancleID + " style=\"margin:0 auto;padding-top:15px;padding-left:35px\">\
                                            <li style=\"font-size:12px;cursor:hand;color:#0000ff;padding-right:15px\" onclick=\"Cancle(this)\">取消</li>\
                                            <li style=\"font-size:12px;cursor:hand;color:#0000ff;padding-right:15px\" onclick=\"openFile(this)\">打开</li>\
                                            <li style=\"font-size:12px;cursor:hand;color:#0000ff;margin-right:0px;padding-right:15px\" onclick=\"openDocument(this)\">打开文件夹</li>\
                                        </ul>\
                                    </div>\
                                </div>\
                                </div>\
                            </li>\
                        </ul>\
                    </div>\
                 </div>");
            window.scrollTo(0, document.body.scrollHeight);
        }
        function openFile(thisa) {
            var id = thisa.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.getElementsByTagName("img")[0].getAttribute("id");

            if (id != null) {
                IMPerChat.OpenFile(id);
            } else {
                alert("openDocument id == null");
            }
        }
        //added by wangqingjie
        function openDocument(thisa) {
            var id = thisa.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.getElementsByTagName("img")[0].getAttribute("id");

            if (id != null) {
                IMPerChat.OpenDocument(id);
            } else {
                alert("openDocument id == null");
            }

        }
        //end add
        function Cancle(thisa) {
            if (thisa.innerHTML == "取消") {
                thisa.innerHTML = "重新发送";

                var id = thisa.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.getElementsByTagName("img")[0].getAttribute("id");
                var ulid = id.concat("send");
                var liarr = document.getElementById(ulid).getElementsByTagName("li");
                for (i in liarr) {
                    if (liarr[i].innerHTML == "正在发送文件...") {
                        liarr[i].innerHTML = "";
                    }
                }

                IMPerChat.CancleLoadorDownLoad();
            } else if (thisa.innerHTML == "重新发送") {
                thisa.innerHTML = "取消";
                var div = thisa.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode;
                div.parentNode.removeChild(div);

                var obj = thisa.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.getElementsByTagName("img");
                var id = obj[0].getAttribute("id");
                IMPerChat.doSendFileByID(id);
            }
        }
        function SendGroupFile(strImgPath, strFileName, strMsgID, MsgState, strPicPath, strUlID, size) {
            var obj = document.getElementById("content");
            var strMsgState = GetMsgState(MsgState);
            var strMsg = cutstr(strFileName, 15);
            var progressID = strMsgID.concat("bar");
            var CancleID = strMsgID.concat("can");
            obj.insertAdjacentHTML("beforeEnd",
                "<div style='overflow:hidden; '>\
                    <p class='divMyHead'>\
                        <img width=30px height=30px src =" + strImgPath + " />\
                    </p>\
                    <div style='float:right;'>\
                         <ul class=''>\
                            <li>\
                                <img id=" + strMsgID + " class='MessageState' style='border-radius:50%;' width=12px height=12px src=" + strMsgState + "\>\
                            </li>\
                            <li>\
                                <div class='triangle-right right' style=\"width:250px;height:90px\">\
                                <div style='width: 100%;height: 100%;background-color: white;'>\
                                    <div class='lb'style=\"height:60;\">\
                                        <div><img  style='margin: 5px;' width=54x height=54px src="+ strPicPath + " /></div>\
                                        <div class='namesta' style=\"margin:0 auto;\">\
                                            <ul id=" + strUlID + " style=\"margin:0 auto;padding-left:15px \">\
                                                <li style='font-size:12px;height:30px;margin-top:10px; color:black'>" + strMsg + " " + size + "</li>\
                                                <li style='font-size:12px;margin-top:5px;'>正在发送文件...</li>\
                                            </ul>\
                                       </div>\
                                    </div>\
                                    <div style=\"margin-top:3px;padding-top:6px;width: 250px; height: 0px; border: solid 0px #ccc; position:relative\">\
                                        <div style=\"background-color: #E0EEE0; width: 250px; height: 1px;position:absolute;left:0;top:0\"></div>\
                                        <div id=" + progressID + " style=\"background-color: #E0EEE0; width: 250px; height: 1px;position:absolute;left:0;top:0\"></div>\
                                    </div>\
                                    <div class='btn' style=\"margin:0 auto;\">\
                                        <ul id=" + CancleID + " style=\"margin:0 auto;padding-top:15px;padding-left:35px\">\
                                            <li style=\"font-size:12px;cursor:hand;color:#0000ff;padding-right:15px\" onclick=\"CancleGroup(this)\">取消</li>\
                                            <li style=\"font-size:12px;cursor:hand;;padding-right:15px;color:#0000ff\" onclick=\"openGroupFile(this)\">打开</li>\
                                            <li style=\"font-size:12px;cursor:hand;margin-right:0px;padding-right:15px;color:#0000ff\" onclick=\"openGroupDocument(this)\">打开文件夹</li>\
                                        </ul>\
                                    </div>\
                                </div>\
                                </div>\
                            </li>\
                        </ul>\
                    </div>\
                 </div>");
            window.scrollTo(0, document.body.scrollHeight);
        }
        function openGroupFile(thisa) {
            var obj = thisa.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.getElementsByTagName("img");
            var filename = obj[0].getAttribute("id");
            GroupChatWidget.slotOpenGroupFile(filename);
        }
        function CancleGroup(thisa) {
            if (thisa.innerHTML == "取消") {
                thisa.innerHTML = "重新发送";
                GroupChatWidget.slotCancleLoadorDownLoad();
            } else if (thisa.innerHTML == "重新发送") {
                thisa.innerHTML = "取消";
                var obj = thisa.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.getElementsByTagName("img");
                var filename = obj[0].getAttribute("id");
                GroupChatWidget.slotSendFile(filename);
            }
        }


        function openGroupDocument(thisa) {
            var id = thisa.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.getElementsByTagName("img")[0].getAttribute("id");

            if (id != null) {
                GroupChatWidget.slotOpenDocument(id);
            }
        }
        //added by wangqingjie 
        function RecFile(strImgPath, FileName, strPicPath, strFileId, strUlID, strULID2, strSize) {

            var FileName = cutstr(FileName, 15);
            var progressID = strFileId.concat("bar");

            var obj = document.getElementById("content");
            obj.insertAdjacentHTML("beforeEnd",
                "<div id= " + strFileId + " style='overflow:hidden;'>\
			        <p class=\"divotherhead\">\
			           <img width=30px height=30px src=" + strImgPath + " />\
			        </p>\
			        <div class=\"triangle-left left\" style=\" width:250px;height:90px\">\
			        <div style='width: 100%;height: 100%;background-color: white;'>\
				        <div class='lb'style=\"height:60px;\">\
                            <div>\
                     	        <img style='margin: 5px;' width=54x height=54px src=" + strPicPath + " />\
                            </div>\
                            <div class='namesta' style=\"height:64px;margin:0 auto;\">\
                                <ul id=" + strULID2 + " style=\"margin:0px auto;padding-left:15px;\">\
                                    <li style='font-size:12px;height:30px;margin-top:10px;color:black'>" + FileName + " " + strSize + "</li>\
                                    <li style='font-size:12px;margin-top:5px;'>有文件需要接收...</li>\
                                </ul>\
                            </div>\
                        </div>\
                        <div style=\"margin-top:3px;padding-top:6px;width: 250px; height: 0px; border: solid 0px #ccc; position:relative\">\
                           <div style=\"background-color: #E0EEE0; width: 250px; height: 1px;position:absolute;left:0;top:0\"></div>\
                           <div id=" + progressID + " style=\"background-color: #E0EEE0; width: 250px; height: 1px;position:absolute;left:0;top:0\"></div>\
                        </div>\
                        <div class='btn'>\
                            <ul id= " + strUlID + " style=\"margin:0 auto\">\
                                <li style=\"font-size:12px;cursor:hand;padding-top:15px;color:#0000ff;padding-right:30px\" onclick=\"getFile(this)\">接收</li>\
                                <li style=\"font-size:12px;cursor:hand;padding-top:15px;color:#0000ff;padding-right:30px\" onclick=\"saveFile(this)\">另存为</li>\
                            </ul>\
                        </div>\
                   </div>\
                   </div>\
		        </div>");
            window.scrollTo(0, document.body.scrollHeight);
        }
        //end add
        function RecGroupFile(strImgPath, strNickName, strFileName, strPicPath, strFileId, strUlID, strUlID2, strSize) {
            var FileName = cutstr(strFileName, 15);
            var progressID = strFileId.concat("bar");
            var obj = document.getElementById("content");
            obj.insertAdjacentHTML("beforeEnd",
                "<div id= " + strFileId + " style='overflow:hidden;'>\
			        <p class=\"divotherhead\">\
			           <img width=30px height=30px src=" + strImgPath + " />\
			           <div style='text-align:left;color:#B2B2B2;font-size:12px;margin-left:10px'>" + strNickName + "</div>\
			        </p>\
			        <div class=\"triangle-left left\" style=\" width:250px;height:90px\">\
			        <div style='width: 100%;height: 100%;background-color: white;'>\
				        <div class='lb'style=\"height:60px;\">\
                            <div>\
                     	        <img style='margin: 5px;' width=54x height=54px src=" + strPicPath + " />\
                            </div>\
                            <div class='namesta' style=\"height:64px;margin:0 auto;\">\
                                <ul id=" + strUlID2 + " style=\"margin:0px auto;padding-left:15px;\">\
                                    <li style='font-size:12px;height:30px;margin-top:10px;color:black'>" + FileName + " " + strSize + "</li>\
                                    <li style='font-size:12px;margin-top:5px;'>有文件需要接收...</li>\
                                </ul>\
                            </div>\
                        </div>\
                        <div style=\"margin-top:3px;padding-top:6px;width: 250px; height: 0px; border: solid 0px #ccc; position:relative\">\
                           <div style=\"background-color: #E0EEE0; width: 250px; height: 1px;position:absolute;left:0;top:0\"></div>\
                           <div id=" + progressID + " style=\"background-color: #E0EEE0; width: 250px; height: 1px;position:absolute;left:0;top:0\"></div>\
                        </div>\
                        <div class='btn'>\
                            <ul id= " + strUlID + " style=\"margin:0 auto\">\
                                <li style=\"font-size:12px;cursor:hand;padding-top:15px;color:#0000ff;padding-right:30px\" onclick=\"getGroupFile(this)\">接收</li>\
                                <li style=\"font-size:12px;cursor:hand;padding-top:15px;color:#0000ff;padding-right:30px\" onclick=\"saveGroupFile(this)\">另存为</li>\
                            </ul>\
                        </div>\
                   </div>\
                   </div>\
		        </div>");
            window.scrollTo(0, document.body.scrollHeight);
        }
        function getFile(thisa) {
            //alert(thisa);
            if (thisa.innerText == "接收") {
                var liarr = thisa.parentNode.getElementsByTagName("li");
                for (var i in liarr) {
                    if (liarr[i].innerHTML == "另存为") {
                        liarr[i].innerHTML = "取消";
                    }
                    if (liarr[i].innerHTML == "接收") {
                        liarr[i].innerHTML = "";
                    }
                }

                var objid = thisa.parentNode.parentNode.parentNode.parentNode.parentNode.getAttribute("id");
                if (objid != null) {
                    //alert(objid);
                    IMPerChat.GetFile(objid);
                }
            }
            if (thisa.innerText == "打开") {
                var objid = thisa.parentNode.parentNode.parentNode.parentNode.parentNode.getAttribute("id");
                if (objid != null) {
                    //alert(objid);
                    IMPerChat.OpenFile(objid);
                }
            }
        }

        function saveFile(thisa) {
            if (thisa.innerText == "另存为") {
                var bl;
                var objid = thisa.parentNode.parentNode.parentNode.parentNode.parentNode.getAttribute("id");
                if (objid != null) {
                    //alert(objid);
                    bl = IMPerChat.SaveFile(objid);
                }

                if (bl != 0) {
                    var liarr = thisa.parentNode.getElementsByTagName("li");
                    for (var i in liarr) {
                        if (liarr[i].innerHTML == "另存为") {
                            liarr[i].innerHTML = "取消";
                        }
                        if (liarr[i].innerHTML == "接收") {
                            liarr[i].innerHTML = "";
                        }
                    }
                }

            } else if (thisa.innerHTML == "打开文件夹") {
                var objid = thisa.parentNode.parentNode.parentNode.parentNode.parentNode.getAttribute("id");
                if (objid != null) {
                    //alert(objid);
                    IMPerChat.OpenDocument(objid);
                }
            } else if (thisa.innerHTML == "取消") {
                var liarr = thisa.parentNode.getElementsByTagName("li");
                for (var i in liarr) {
                    if (liarr[i].innerHTML == "") {
                        liarr[i].innerHTML = "接收";
                    }
                    if (liarr[i].innerHTML == "取消") {
                        liarr[i].innerHTML = "另存为";
                    }
                }

                var divid = thisa.parentNode.parentNode.parentNode.parentNode.parentNode.getAttribute("id");
                //alert(divid);
                var ulid = divid.concat("recv2");
                var arrli = document.getElementById(ulid).getElementsByTagName("li");
                for (var j in arrli) {

                    if (arrli[j].innerHTML == "正在接收文件...") {
                        arrli[j].innerHTML = "有文件需要接收...";
                    }
                }

                IMPerChat.CancleLoadorDownLoad();
            }

        }
        function getGroupFile(thisa) {
            //alert(thisa);
            if (thisa.innerText == "接收") {
                var liarr = thisa.parentNode.getElementsByTagName("li");
                for (var i in liarr) {
                    if (liarr[i].innerHTML == "另存为") {
                        liarr[i].innerHTML = "取消";
                    }
                    if (liarr[i].innerHTML == "接收") {
                        liarr[i].innerHTML = "";
                    }
                }

                var objid = thisa.parentNode.parentNode.parentNode.parentNode.parentNode.getAttribute("id");
                if (objid != null) {
                    //alert(objid);
                    GroupChatWidget.slotGetFile(objid);
                }
            }
            if (thisa.innerText == "打开") {
                var objid = thisa.parentNode.parentNode.parentNode.parentNode.parentNode.getAttribute("id");
                if (objid != null) {
                    //alert(objid);
                    GroupChatWidget.slotOpenGroupFile(objid);
                }
            }
        }

        function saveGroupFile(thisa) {
            if (thisa.innerText == "另存为") {
                var bl;
                var objid = thisa.parentNode.parentNode.parentNode.parentNode.parentNode.getAttribute("id");
                if (objid != null) {
                    //alert(objid);
                    bl = GroupChatWidget.slotSaveFile(objid);
                }

                if (bl != 0) {
                    var liarr = thisa.parentNode.getElementsByTagName("li");
                    for (var i in liarr) {
                        if (liarr[i].innerHTML == "另存为") {
                            liarr[i].innerHTML = "取消";
                        }
                        if (liarr[i].innerHTML == "接收") {
                            liarr[i].innerHTML = "";
                        }
                    }
                }

            } else if (thisa.innerHTML == "打开文件夹") {
                var objid = thisa.parentNode.parentNode.parentNode.parentNode.parentNode.getAttribute("id");
                if (objid != null) {
                    //alert(objid);
                    GroupChatWidget.slotOpenDocument(objid);
                }
            } else if (thisa.innerHTML == "取消") {
                var liarr = thisa.parentNode.getElementsByTagName("li");
                for (var i in liarr) {
                    if (liarr[i].innerHTML == "") {
                        liarr[i].innerHTML = "接收";
                    }
                    if (liarr[i].innerHTML == "取消") {
                        liarr[i].innerHTML = "另存为";
                    }
                }

                var divid = thisa.parentNode.parentNode.parentNode.parentNode.parentNode.getAttribute("id");
                //alert(divid);
                var ulid = divid.concat("recv2");
                var arrli = document.getElementById(ulid).getElementsByTagName("li");
                for (var j in arrli) {

                    if (arrli[j].innerHTML == "正在接收文件...") {
                        arrli[j].innerHTML = "有文件需要接收...";
                    }
                }
                GroupChatWidget.slotCancleLoadorDownLoad();
            }

        }
        //added by wangqingjie
        function ChangeLi(strUlID) {
            var obj = document.getElementById(strUlID).getElementsByTagName("li");
            for (i in obj) {

                if (obj[i].innerHTML == "正在发送文件...") {
                    obj[i].innerHTML = "成功发送文件!";
                }

                if (obj[i].innerHTML == "取消") {
                    obj[i].innerHTML = "";
                }
            }
        }

        function ChangeLiTwo(strUlID) {
            var obj = document.getElementById(strUlID).getElementsByTagName("li");
            for (i in obj) {
                if (obj[i].innerHTML == "取消") {
                    obj[i].innerHTML = "打开文件夹";
                }
                if (obj[i].innerHTML == "正在接收文件...") {
                    obj[i].innerHTML = "已成功接收文件";
                }
                if (obj[i].innerHTML == "有文件需要接收...") {
                    obj[i].innerHTML = "正在接收文件...";
                }
                if (obj[i].innerHTML == "接收") {
                    obj[i].innerHTML = "";
                }
                if (obj[i].innerHTML == "另存为") {
                    obj[i].innerHTML = "打开文件夹";
                }
                if (obj[i].innerHTML == "") {
                    obj[i].innerHTML = "打开";
                }
            }
        }
        function ChangeLiThr(ID) {
            var obj = document.getElementById(ID).getElementsByTagName("li");
            for (i in obj) {
                if (obj[i].innerHTML == "") {
                    obj[i].innerHTML = "接收";
                }
                if (obj[i].innerHTML == "取消") {
                    obj[i].innerHTML = "另存为";
                }
                if (obj[i].innerHTML == "正在接收文件...") {
                    obj[i].innerHTML = "有文件需要接收...";
                }
            }

        }
        //end added
        function RecAppend(strImgPath, strMsg, strMsgID) {
            
            //added by wangqingjie
            var objsrc = document.getElementById(strMsgID);
            if (objsrc != null) {
                objsrc.parentNode.removeChild(objsrc);

            }
            //end added

            var obj = document.getElementById("content");
            var h = "<div id=" + strMsgID + "  style='overflow:hidden;'><p class='divotherhead'><img width=30px height=30px src = " + strImgPath + " \></p><p class='triangle-left left'ondblclick=\"ChangeSize(this)\"> " + strMsg + " </p></div>";
            obj.insertAdjacentHTML("beforeEnd", h);
            window.setTimeout("window.scrollTo(0, document.body.scrollHeight);", 0);
        }
        function VdoAppend(strImgPath, strMsg, strMsgID) {
            //added by wangqingjie
            var objsrc = document.getElementById(strMsgID);
            if (objsrc != null) {
                objsrc.parentNode.removeChild(objsrc);

            }
            //end added

            var obj = document.getElementById("content");
            var h = "<div id=" + strMsgID + "  style='overflow:hidden;'><p class='divotherhead'><img width=30px height=30px src = " + strImgPath + " \></p><p class='triangle-left left' onclick=\"videoPlay(this)\"> <img src='qrc:/PerChat/Resources/html/readyPlay.png' style='position:absolute;'>" + strMsg + " </p></div>";
            obj.insertAdjacentHTML("beforeEnd", h);
            
            //将播放标志放到正中。
            var div = document.getElementById(strMsgID);
            var videoList = div.getElementsByTagName("video");
            var video = videoList[0];
            var imgList = div.getElementsByTagName("img");
            var img = imgList[1];  //播放标志是第二个img标签。
            var x = (parseInt(video.offsetWidth) - 100) / 2;
            var y = (parseInt(video.offsetHeight) - 100) / 2;
            img.style.top = y.toString();
            img.style.left = x.toString();
            
            window.scrollTo(0, document.body.scrollHeight);
        }

        function ChangeSize(thisa) {
            var Ptr = thisa.getElementsByTagName("img");
            var src = Ptr[0].src;

            IMPerChat.slotZoomImg(src); 
        }

        function videoPlay(thisa)
        {
            var Ptr = thisa.getElementsByTagName("video");
            var src = Ptr[0].src;

            IMPerChat.videoPlay(src);
        }

        // wxd add code - start
        // note : 群组聊天接收消息后显示头像加昵称
        function GroupRecvAppend(strImgPath, strMsg, strBuddyNickName, strMsgId) {
            //added by wangqingjie
            var objdiv = document.getElementById(strMsgId);
            if (objdiv != null) {
                objdiv.parentNode.removeChild(objdiv);
            }
            //end added

            var obj = document.getElementById("content");
            obj.insertAdjacentHTML("beforeEnd", "<div id=" + strMsgId + " style='overflow:hidden;'><p class='divotherhead'><img width=30px height=30px src = " + strImgPath + " \><div style='text-align:left;color:#B2B2B2;font-size:12px;margin-left:10px'>" + strBuddyNickName + "</div></p><p class='triangle-left left' ondblclick=\"ChangeGroupSize(this)\">" + strMsg + "</p></div>");
            window.setTimeout("window.scrollTo(0, document.body.scrollHeight);", 0);
        }
        function GroupVdoAppend(strImgPath, strMsg, strBuddyNickName, strMsgId) {
            //added by wangqingjie
            var objdiv = document.getElementById(strMsgId);
            if (objdiv != null) {
                objdiv.parentNode.removeChild(objdiv);
            }
            //end added

            var obj = document.getElementById("content");
            obj.insertAdjacentHTML("beforeEnd", "<div id=" + strMsgId + " style='overflow:hidden;'><p class='divotherhead'><img width=30px height=30px src = " + strImgPath + " \><div style='text-align:left;color:#B2B2B2;font-size:12px;margin-left:10px'>" + strBuddyNickName + "</div></p><p class='triangle-left left' onclick=\"GroupVideoPlay(this)\"><img src='qrc:/PerChat/Resources/html/readyPlay.png' style='position:absolute;'>" + strMsg + "</p></div>");
            //将播放标志放到正中。
            var div = document.getElementById(strMsgId);
            var videoList = div.getElementsByTagName("video");
            var video = videoList[0];
            var imgList = div.getElementsByTagName("img");
            var img = imgList[1];  //播放标志是第二个img标签。
            var x = (parseInt(video.offsetWidth) - 100) / 2;
            var y = (parseInt(video.offsetHeight) - 100) / 2;
            img.style.top = y.toString();
            img.style.left = x.toString();
            
            window.scrollTo(0, document.body.scrollHeight);
        }
        function ChangeGroupSize(thisa) {
            var Ptr = thisa.getElementsByTagName("img");
            var src = Ptr[0].src;

            GroupChatWidget.slotZoomImg(src);
        }
        function GroupVideoPlay(thisa)
        {
        	var Ptr = thisa.getElementsByTagName("video");
            var src = Ptr[0].src;

            GroupChatWidget.slotVideoPlay(src);
        }
        // wxd add code - end
        function choosephoto() {
            var obj = document.getElementById("content");
            obj.insertAdjacentHTML("afterEnd", "<div style='overflow:hidden;'><p class='divMyHead' width='30px' height='30px'></p><p class='triangle-right right'>nice</p></div>");
        }
        function clear() {
            document.body.innerHTML = '';
        }

        function openUrl(thisa) {
            var msgID = thisa.getAttribute("name");
            IMPerChat.OpenUrl(msgID);
        }

        function SendTask(strImgPath, strSystemName, strImgeUrl, strTime, strTitle, MsgState, StrMsgID) {
            var obj = document.getElementById("content");
            var strMsgState = GetMsgState(MsgState);
            obj.insertAdjacentHTML("beforeEnd",
                "<div style='overflow:hidden;'>\
                    <p class='divMyHead'>\
                        <img width=30px height=30px src =" + strImgPath + " />\
                    </p>\
                    <div style='float:right;'>\
                         <ul class=''>\
                            <li>\
                                <img id=" + StrMsgID + " class='MessageState' style='border-radius:50%;' width=12px height=12px src=" + strMsgState + "\>\
                            </li>\
                            <li>\
                                <div class='triangle-right right' style=\"width:250px;height:90\">\
                                    <div class='lb'style=\"height:60px;\">\
										<div>\
										<img name = " + StrMsgID + " onclick=\"openUrl(this)\" style='cursor:hand;' width=64px height=64px src=" + strImgeUrl + " />\
										</div>\
										<div class='namesta' style=\"margin:0 auto;\">\
                                            <ul style=\"margin:0 auto;padding-left:15px \">\
												<text>" + strTitle + "</text><br>\
                                            </ul>\
										</div>\
										<div style=\"margin-top:3px;padding-top:6px;width: 250px; height: 0px; border: solid 0px #ccc; position:relative\">\
											<div style=\"background-color: #E0EEE0; width: 250px; height: 1px;position:absolute;left:0;top:0\"></div>\
											<div style=\"background-color: #E0EEE0; width: 250px; height: 1px;position:absolute;left:0;top:0\"></div>\
										</div>\
										<div class='btn'style=\"margin:0 auto;\">\
											<ul style=\"margin:0 auto;width: 250px;height: 22px; padding: 0px;\">\
												<li style=\"font-size:12px;padding-top:15px;color:#000000;float:left;\">" + strSystemName + "</li>\
												<li style=\"font-size:12px;padding-top:15px;color:#000000;float:right;\">" + strTime + "</li>\
											</ul>\
										</div>\
									</div>\
                                </div>\
                            </li>\
                        </ul>\
                    </div>\
                 </div>");
            window.scrollTo(0, document.body.scrollHeight);
        }

        function RecTask(strImgPath, strSystemName, strImgeUrl, strTime, strTitle, strSubtitle, strClicketUrl, StrMsgID) {
            var obj = document.getElementById("content");
            obj.insertAdjacentHTML("beforeEnd",
                "<div id= " + StrMsgID + " style='overflow:hidden;'>\
			        <p class=\"divotherhead\">\
			            <img width=30px height=30px src=" + strImgPath + " />\
			        </p>\
			        <div class=\"triangle-left left\" style=\" width:220px;height:90px\">\
				        <div class='lb'style=\"height:60px;\">\
                            <div>\
                     	        <img name = " + StrMsgID + " onclick=\"openUrl(this)\" style='cursor:hand;' width=64px height=64px src=" + strImgeUrl + " />\
                            </div>\
                            <div class='namesta' style=\"height:64px;margin:0 auto;\">\
                                <ul  style=\"margin:0px auto;padding-left:15px;\">\
						            <text>" + strTitle + "</text><br>\
                                    <text>" + strSubtitle + "</text>\
					            </ul>\
                            </div>\
                        </div>\
                        <div style=\"margin-top:3px;padding-top:6px;width: 220px; height: 0px; border: solid 0px #ccc; position:relative\">\
                           <div style=\"background-color: #E0EEE0; width: 220px; height: 1px;position:absolute;left:0;top:0\"></div>\
                           <div style=\"background-color: #E0EEE0; width: 220px; height: 1px;position:absolute;left:0;top:0\"></div>\
                        </div>\
                        <div class='btn'>\
                            <ul style=\"margin:0 auto;width: 220px;height: 22px; padding: 0px;\">\
                                <li style=\"font-size:12px;padding-top:15px;color:#000000;float:left;\">" + strSystemName + "</li>\
                                <li style=\"font-size:12px;padding-top:15px;color:#000000;float:right;\">" + strTime + "</li>\
                            </ul>\
                        </div>\
                   </div>\
		        </div>");
            window.scrollTo(0, document.body.scrollHeight);
        }
    </script>

</head>
<body id="content" style="background:#FFFFFF">
</body>
<script type="text/javascript">
    
	window.onload = function(){
		//SendGroupAppend("C:/Users/Administrator/Pictures/1.jpg", "sadfdsaf", "sdafasf", "sadfsadf");
		//SendGroupAppend("C:/Users/Administrator/Pictures/1.jpg", "sadfdsaf", "sdafasfd", "sadfsadf");
		//GroupRecvAppend("C:/Users/Administrator/Pictures/1.jpg", "strMsg", "fsdf ", "sdaf");
		//GroupRecvAppend("C:/Users/Administrator/Pictures/1.jpg", "strMsg", "fsddf ", "sdafs");
		/*
		//VdoAppend("C:/Users/Administrator/Pictures/1.jpg", "<video  height='180px'  controls src='file:///D:/sky.webm' />", "sdafasf");
		//VdoAppend("C:/Users/Administrator/Pictures/1.jpg", "<video width='320px' height='180px' style='object-fit: fill;' src='file:///D:/sky.webm' />", "sdafasfs");
		//GroupVdoAppend("file:///D:/project/IMChatClient/IMChatClient/resource/header/6738/1196_2883.jpg", 
		//"<video width='320px' height='180px' style='object-fit: fill;' src='file:///D:/project/IMChatClient/IMChatClient/resource/vedio/6738/00000B43000004AC0000015DE8A9F1570000201D01.mp4'/>",
		//"测试",
		//"00000B43000004AC0000015DE8A9F1570000201D01"
		//);
		
		//SendAppend("qrc:/PerChat/Resources/person/temp.png","<img src='file:///C:/Users/Administrator/Pictures/1.jpg'/>","000010CB000013430000015E185C9BE00000005F00",0);
		//SendGroupAppend("C:\Users\Administrator\Pictures\1.jpg", "sadfdsaf", "sdafasf", "sadfsadf");
		//SendGroupAppend("C:\Users\Administrator\Pictures\1.jpg", "sadfdsaf", "sdafasfd", "sadfsadf");
		//GroupRecvAppend("C:\Users\Administrator\Pictures\1.jpg", "strMsg", "fsdf ", "sdaf");
		//GroupRecvAppend("C:\Users\Administrator\Pictures\1.jpg", "strMsg", "fsddf ", "sdafs");
		//SendAppend("C:\Users\Administrator\Pictures\1.jpg", "asdf", "dasfadsfdsa", "dsfads");
		//SendAppend("C:\Users\Administrator\Pictures\1.jpg", "asdf", "dasfadsfdsa", "dsfads");
		//RecAppend("C:\Users\Administrator\Pictures\1.jpg", "strMsg", "strMsgID");
		//RecAppend("C:\Users\Administrator\Pictures\1.jpg", "strMsg", "strMsgIdD");
		SendGroupFile("file:///D:/project/IMChatClient/IMChatClient/resource/header/204.jpg",
		"新建文本文档.txt",
		"000000CC00001A520000015E5B762900000003D500",
		0,
		"qrc:/FileType/Resources/FileType/010.png",
		"000000CC00001A520000015E5B762900000003D500send",
		"(1.00KB)"
		);
		RecGroupFile(
			"file:///D:/project/IMChatClient/IMChatClient/resource/header/2883.jpg",
			"mark",
			"1.txt",
			"qrc:/FileType/Resources/FileType/010.png",
			"00000B43000000CC0000015E5BA551F80000139400",
			"00000B43000000CC0000015E5BA551F80000139400recv",
			"00000B43000000CC0000015E5BA551F80000139400recv2",
			"(50.00B)"
		);
		SendAppend("strImgPath", "第三方的萨芬的萨芬", "strMsgID", "MsgState");
		*/
	};
    
</script>
</html>